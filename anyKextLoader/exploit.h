//
//  exploit.h
//  anyKextLoader
//
//  Created by Linus Henze on 30/07/15.
//  Copyright Â© 2016 Linus Henze. All rights reserved.
//

#ifndef exploit_h
#define exploit_h

#include <stdio.h>
#include <stdbool.h>
#include <mach/mach.h>

typedef struct {
    mach_msg_header_t          header;
    mach_msg_body_t            body;
    mach_msg_port_descriptor_t task_port;
} mach_message;

typedef struct {
    mach_msg_header_t          header;
    mach_msg_body_t            body;
    mach_msg_port_descriptor_t task_port;
    mach_msg_trailer_t         trailer;
} mach_message_recv;

void __attribute__((noreturn)) startExeSuspended(char *exe, int argc, char * argv[]);
mach_port_t receivePort(mach_port_t recvPort);
bool sendPort(mach_port_t dest, mach_port_t send_port);
mach_port_t forkAndGetTaskPortForProcess(pid_t *child_pid, char *exe, int argc, char * argv[]);

#endif /* exploit_h */
